<!-- Steps -->
<ng-container *ngIf="MostrarfabricaDatos">
    <mat-tab-group class="fuse-mat-no-header" [animationDuration]="'200'">

        <ng-container>
            <!-- formulario de referencia  -->
            <form [formGroup]="form">
                <mat-tab *ngIf="currentStep==0">
                    <div
                        class="prose prose-sm min-w-11/12 max-w-11/12 mx-auto sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card">
                        <h2 class="ml-2.5 text-md sm:text-xl  tracking-tight truncate font-bold">
                            Datos de la llamada
                        </h2>
                        <div class="grid sm:grid-cols-3 grid-cols-2 mb-1">
                            <fuse-card class="flex items-center max-w-80 w-full p-6 filter-info border-2 rounded-2 ">
                                <mat-icon class="icon-size-12" [svgIcon]="'iconsmind:smartphone_2'"></mat-icon>
                                <div class="flex flex-col">
                                    <div class="text-2xl font-semibold leading-tight">{{fabricaDatos.celular}}</div>
                                    <div class="text-md text-secondary">Celular</div>
                                </div>
                            </fuse-card>
                            <fuse-card
                                class="flex items-center w-full p-6 filter-info border-2 rounded-2 md:ml-4 col-span-2">
                                <mat-icon class="icon-size-12 mr-6" [svgIcon]="'iconsmind:file_clipboardfiletext'">
                                </mat-icon>
                                <div class="flex flex-col ">
                                    <div class="text-2xl font-semibold leading-tight capitalize">
                                        {{fabricaDatos.nombreCompleto}}
                                    </div>
                                    <div class="text-md text-secondary">{{fabricaDatos.correoElectronico}}.</div>
                                </div>
                            </fuse-card>
                        </div>
                        <hr>
                        <div class="flex justify-between items-center ">
                            <p>¿El contacto fue realizado al número del formulario?</p>
                            <div class="toggle-button-cover">
                                <div class="button-cover">
                                    <div class="button r" id="button-1">
                                        <input type="checkbox" class="checkbox"
                                            (change)="form.controls['numeroFormularioValida_bool'].setValue(true)"
                                            formControlName="telefonoContactoValida_bool">
                                        <div class="knobs"></div>
                                        <div class="layer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-between items-center" *ngIf="!form.value.telefonoContactoValida_bool">
                            <p>¿El teléfono del formulario es correcto?</p>
                            <div class="toggle-button-cover">
                                <div class="button-cover">
                                    <div class="button r" id="button-1">
                                        <input type="checkbox" class="checkbox"
                                            formControlName="numeroFormularioValida_bool">
                                        <div class="knobs"></div>
                                        <div class="layer"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-2" *ngIf="!form.value.numeroFormularioValida_bool">
                            <mat-form-field class="w-full fuse-mat-dense">
                                <mat-label>Ingresa el teléfono de contacto </mat-label>
                                <input matInput type="text" [formControlName]="'celular'" readonly>
                            </mat-form-field>
                            <mat-form-field class="w-full fuse-mat-dense">
                                <mat-label>Teléfono / Celular corregido: </mat-label>
                                <input matInput type="text" [formControlName]="'telefonoContactoCorregido'">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                                <mat-error
                                    *ngIf="(form.controls.telefonoContactoCorregido.dirty || form.controls.telefonoContactoCorregido.touched)">
                                    <mat-error *ngIf="form.controls.telefonoContactoCorregido.errors?.required ">
                                        Este campo es
                                        requerido.</mat-error>
                                    <mat-error *ngIf="form.controls.telefonoContactoCorregido.errors?.pattern">
                                        Solo se aceptan
                                        números.</mat-error>
                                    <mat-error *ngIf="form.controls.telefonoContactoCorregido.errors?.minlength">
                                        Longitud
                                        mínima son 7 dígitos.</mat-error>
                                    <mat-error *ngIf="form.controls.telefonoContactoCorregido.errors?.maxlength">
                                        Longitud
                                        máxima son 11 dígitos.</mat-error>
                                </mat-error>
                            </mat-form-field>
                        </div>



                        <div class="mt-3" *ngIf="!form.value.numeroFormularioValida_bool">
                            <p class="m-0">Motivo por la cual se cambia el número de telefono </p>
                            <quill-editor class="mb-2" placeholder="Motivo de las obligaciones en mora..."
                                name="descripcion" [modules]="quillModules"
                                [formControlName]="'telefonoContactoObservacion'"></quill-editor>
                        </div>

                        <div class="grid grid-cols gap-2">
                            <div class="flex justify-between items-center">
                                <p>¿El correo electrónico del formulario es correcto
                                    <strong>{{fabricaDatos.correoElectronico}}</strong>
                                    ?
                                </p>
                                <div class="toggle-button-cover">
                                    <div class="button-cover">
                                        <div class="button r" id="button-1">
                                            <input type="checkbox" class="checkbox"
                                                formControlName="correoElectronicoValida_bool">
                                            <div class="knobs"></div>
                                            <div class="layer"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-2" *ngIf="!form.value.correoElectronicoValida_bool">
                            <mat-form-field class="w-full fuse-mat-dense mt-3">
                                <mat-label>Correo electrónico corregido </mat-label>
                                <input matInput type="email" [formControlName]="'correoElectronicoCorregido'">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                        </div>
                    </div>

                </mat-tab>

                <mat-tab *ngIf="currentStep==1">
                    <div
                        class="prose prose-sm min-w-11/12 max-w-11/12 mx-auto sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card">
                        <h2 class="ml-2.5 text-md sm:text-xl  tracking-tight truncate font-bold">
                            Datos del titular
                        </h2>
                        <div class="grid grid-cols-12">
                            <div class="col-span-12">

                                <div class="flex justify-between items-center">
                                    <p>¿El titular nacio en
                                        <strong>{{fabricaDatos.fechaNacimiento}}</strong>?
                                    </p>
                                    <div class="toggle-button-cover">
                                        <div class="button-cover">
                                            <div class="button r" id="button-1">
                                                <input type="checkbox" class="checkbox"
                                                    formControlName="fechaNacimientoValida_bool">
                                                <div class="knobs"></div>
                                                <div class="layer"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="-mx-3 md:flex mt-3 mb-2" *ngIf="!form.value.fechaNacimientoValida_bool">
                                    <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                                        <mat-label>Fecha de nacimiento</mat-label>
                                        <input matInput type="date" [formControlName]="'fechaNacimientoCorregido'">
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <h2 class="ml-2.5 text-md sm:text-xl  tracking-tight truncate font-bold">
                            Información de residencia del titular
                        </h2>
                        <div class="grid grid-cols-12">
                            <div class="col-span-12">
                                <ng-container *ngIf="mostrarDepartamento">
                                    <div class="flex justify-between items-center">
                                        <p *ngIf="fabricaDatos.descripcionDepartamento!==''">
                                            ¿El titular vive en el departamento
                                            <strong>{{fabricaDatos.descripcionDepartamento}}</strong>?
                                        </p>
                                        <div class="toggle-button-cover">
                                            <div class="button-cover">
                                                <div class="button r" id="button-1">
                                                    <input type="checkbox" class="checkbox"
                                                        formControlName="departamentoResidenciaValida_bool">
                                                    <div class="knobs"></div>
                                                    <div class="layer"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>

                                <div class="-mx-3 md:flex mt-3 mb-2"
                                    *ngIf="(!form.value.departamentoResidenciaValida_bool && mostrarDepartamento==true)">
                                    <ng-container *ngIf="departamentos$ | async as departamentos">
                                        <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                                            <mat-label>Departamento {{(form.value.departamentoResidenciaValida_bool &&
                                                mostrarDepartamento==true)}}</mat-label>
                                            <mat-select (selectionChange)="seleccionDepartamento($event)"
                                                [value]="'seleccione'"
                                                [formControlName]="'departamentoResidenciaCorregido'">
                                                <mat-option disabled [value]="'seleccione'">Seleccione
                                                </mat-option>
                                                <mat-option *ngFor="let departamento of departamentos.data"
                                                    [value]="departamento.codigo">{{departamento.nombre}}
                                                </mat-option>
                                            </mat-select>
                                            <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                            </mat-icon>
                                        </mat-form-field>
                                    </ng-container>
                                </div>

                                <ng-container *ngIf="mostrarCiudad==true">
                                    <div class="flex justify-between items-center">
                                        <p>¿El titular vive en la ciudad de
                                            <strong>{{fabricaDatos.descripcionCiudad}}</strong>?
                                        </p>
                                        <div class="toggle-button-cover">
                                            <div class="button-cover">
                                                <div class="button r" id="button-1">
                                                    <input type="checkbox" class="checkbox"
                                                        formControlName="ciudadResidenciaValida_bool">
                                                    <div class="knobs"></div>
                                                    <div class="layer"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>

                                <div class="-mx-3 md:flex mt-3 mb-2"
                                    *ngIf="((!form.value.ciudadResidenciaValida_bool) && (mostrarCiudad==true))">
                                    <ng-container *ngIf="ciudades$ | async as ciudades">
                                        <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                                            <mat-label>Ciudad / Municipio</mat-label>
                                            <mat-select (selectionChange)="seleccionCiudad($event)"
                                                [value]="'seleccione'" [formControlName]="'ciudadResidenciaCorregido'">
                                                <mat-option disabled [value]="'seleccione'">Seleccione
                                                </mat-option>
                                                <mat-option *ngFor="let ciudad of ciudades.data"
                                                    [value]="ciudad.codigo">
                                                    {{ciudad.nombre}}
                                                </mat-option>
                                            </mat-select>
                                            <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                            </mat-icon>
                                        </mat-form-field>
                                    </ng-container>
                                </div>

                                <ng-container>
                                    <div class="flex justify-between items-center">
                                        <p>¿El titular vive en el barrio
                                            <strong>{{fabricaDatos.descripcionBarrio}}</strong>?
                                        </p>
                                        <div class="toggle-button-cover">
                                            <div class="button-cover">
                                                <div class="button r" id="button-1">
                                                    <input type="checkbox" class="checkbox"
                                                        formControlName="barrioResidenciaValida_bool">
                                                    <div class="knobs"></div>
                                                    <div class="layer"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                                <div class="-mx-3 md:flex mt-3 mb-2" *ngIf="!form.value.barrioResidenciaValida_bool ">
                                    <ng-container *ngIf="barrios$ | async as barrios">
                                        <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                                            <mat-label>Barrio</mat-label>
                                            <mat-select [value]="'seleccione'"
                                                [formControlName]="'barrioResidenciaCorregido'">
                                                <mat-option disabled [value]="'seleccione'">Seleccione
                                                </mat-option>
                                                <mat-option *ngFor="let barrio of barrios.data" [value]="barrio.codigo">
                                                    {{barrio.nombre}}
                                                </mat-option>
                                            </mat-select>
                                            <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                            </mat-icon>
                                        </mat-form-field>
                                    </ng-container>
                                </div>
                                <div class="flex justify-between items-center">
                                    <p>¿El titular vive en esta dirección:
                                        <strong>{{fabricaDatos.direccionResidencia}}</strong>?
                                    </p>
                                    <div class="toggle-button-cover">
                                        <div class="button-cover">
                                            <div class="button r" id="button-1">
                                                <input type="checkbox" class="checkbox"
                                                    formControlName="direccionResidenciaValida_bool">
                                                <div class="knobs"></div>
                                                <div class="layer"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="-mx-3 md:flex mt-3 mb-2" *ngIf="!form.value.direccionResidenciaValida_bool">
                                    <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                                        <mat-label>Dirección de residencia</mat-label>
                                        <input matInput type="text" [formControlName]="'direccionResidenciaCorregido'"
                                            (click)="openModalDirection()">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                </div>
                            </div>
                        </div>
                    </div>

                </mat-tab>

                <mat-tab *ngIf="currentStep==2">
                    <div
                        class="prose prose-sm min-w-11/12 max-w-11/12 mx-auto sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card">

                        <h2 class="ml-2.5 text-md sm:text-xl  tracking-tight truncate font-bold">
                            Preguntas a la referencia
                        </h2>

                        <div>
                            <div class="flex justify-between items-center px-3">
                                <p>¿El destino del credito es
                                    <strong>{{fabricaDatos.descripcionDestinoCredito}}</strong>?
                                </p>
                                <div class="toggle-button-cover">
                                    <div class="button-cover">
                                        <div class="button r" id="button-1">
                                            <input type="checkbox" class="checkbox"
                                                formControlName="destinoCreditoCorregido_bool">
                                            <div class="knobs"></div>
                                            <div class="layer"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <ng-container *ngIf="destinoCredito$ | async as destinoCredito">

                                <mat-form-field class="w-1/2 px-3 fuse-mat-dense"
                                    *ngIf="!form.value.destinoCreditoCorregido_bool">
                                    <mat-label>El destino del crédito corregido es: </mat-label>
                                    <mat-select [value]="'seleccione'" [formControlName]="'destinoCreditoCorregido'">
                                        <mat-option disabled [value]="'seleccione'">Seleccione
                                        </mat-option>
                                        <mat-option *ngFor="let item of destinoCredito.data"
                                            [value]="item.codigoOpcion">
                                            {{item.descripcionOpcion}}
                                        </mat-option>
                                    </mat-select>
                                    <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                    </mat-icon>
                                </mat-form-field>

                            </ng-container>

                            <mat-form-field class="w-1/2 px-3 fuse-mat-dense"
                                *ngIf="form.controls['destinoCredito'].value=='OT'">
                                <mat-label>¿Otro? ¿Cual?</mat-label>
                                <input matInput type="text" [formControlName]="'otroDestinoCredito'" [required]="true">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'"></mat-icon>
                            </mat-form-field>
                            <!-- <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                              <mat-label>¿Cuánto tiene de inventario?</mat-label>
                              <input matInput type="text" placeholder="" [formControl
                              Name]="'inventarioActual'"
                                  (keyup)="form.controls['inventarioActual'].setValue(utility.formatearNumero(form.value.inventarioActual)); ">
                              <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                              </mat-icon>
                          </mat-form-field> -->
                            <!-- 
                          <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                              <mat-label>¿Cuánto dinero le debe a proveedores?</mat-label>
                              <input matInput type="text" placeholder="" [formControlName]="'dineroProveedores'"
                                  (keyup)="form.controls['dineroProveedores'].setValue(utility.formatearNumero(form.value.dineroProveedores)); ">
                              <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                              </mat-icon>
                          </mat-form-field>
                          <mat-form-field class="w-1/2 px-3 fuse-mat-dense">
                              <mat-label>¿Cuánto es el valor total de las cuotas a crédito? </mat-label>
                              <input matInput type="text" placeholder=""
                                  [formControlName]="'valorTotalCuotasCreditos'"
                                  (keyup)="form.controls['valorTotalCuotasCreditos'].setValue(utility.formatearNumero(form.value.valorTotalCuotasCreditos)); ">
                              <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                              </mat-icon>
                          </mat-form-field> -->

                            <div class="mt-3 px-3">
                                <p class="labelTxt">¿Cuál es el motivo de las obligaciones en mora?</p>
                                <quill-editor class="mb-2" placeholder="Motivo de las obligaciones en mora..."
                                    name="descripcion" [modules]="quillModules"
                                    [formControlName]="'motivoObligaciones'"></quill-editor>
                            </div>
                        </div>


                    </div>


                </mat-tab>

                <mat-tab *ngIf="currentStep==4">

                    <div
                        class="prose prose-sm min-w-11/12 max-w-11/12 mx-auto sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card">
                        <h2 class="ml-2.5 text-md sm:text-xl  tracking-tight truncate font-bold">
                            Comentario
                        </h2>

                        <div class="flex justify-between items-center ">

                            <mat-form-field class="w-1/2 fuse-mat-dense">
                                <mat-label>¿Resultado de referenciación?</mat-label>
                                <mat-select [value]="'seleccione'" [formControlName]="'referenciaValidada'">
                                    <mat-option disabled [value]="'seleccione'">Seleccione
                                    </mat-option>
                                    <mat-option [value]="'E'">Exitoso
                                    </mat-option>
                                    <mat-option [value]="'N'">No exitoso
                                    </mat-option>
                                    <mat-option [value]="'NO'">No contactado
                                    </mat-option>
                                </mat-select>
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                        </div>
                        <div class="mt-1">
                            <quill-editor #editor (contentChanged)="logChange($event)" class="mb-2"
                                placeholder=" Ingrese aquí el resumen de la referenciación..." name="descripcion"
                                [modules]="quillModules" [formControlName]="'comentarioValidacion'">
                            </quill-editor>
                        </div>
                        <div class="col-lg-12 mt-1.5" *ngIf="editor.editorElem">
                            <small [ngClass]="(editor.editorElem.outerText.length<10)?'text-red-600':'text-green-600'"
                                class="text-sm" *ngIf="editor.editorElem.outerText.length>1">
                                Caracteres : {{ editor.editorElem.outerText.length }}

                            </small>
                        </div>

                        <div class="-mx-3 md:flex mt-3 mb-2 mr-1 justify-end">
                            <button mat-raised-button color="primary" type="button" (click)="onPostDatos()">
                                Guardar
                            </button>
                        </div>
                    </div>

                </mat-tab>
            </form>
            <!-- formualrio de la oferta  -->
            <form [formGroup]="formOferta">
                <mat-tab *ngIf="currentStep==3">
                    <div
                        class="prose prose-sm min-w-11/12 max-w-11/12 mx-auto sm:my-2 lg:mt-4 p-6 sm:p-10 sm:py-12 rounded-2xl shadow overflow-hidden bg-card">
                        <h2 class="ml-2.5 text-md ssm:text-xl  tracking-tight truncate font-bold">
                            Ofertas y capacidad de pagos
                        </h2>

                        <div class="grid grid-cols-1 sm:grid-cols-2">
                            <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                <mat-label>Monto solicitido</mat-label>
                                <input matInput type="text" placeholder="" [formControlName]="'valorSolicitado'"
                                    (keyup)="formOferta.controls['valorSolicitado'].setValue(utility.formatearNumero(formOferta.value.valorSolicitado)); ">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                            <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                <mat-label>Plazo</mat-label>
                                <input matInput type="text" placeholder="" [formControlName]="'plazo'"
                                    (keyup)="formOferta.controls['plazo'].setValue(utility.formatearNumero(formOferta.value.plazo)); ">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                            <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                <mat-label>Salario básico</mat-label>
                                <input matInput type="text" placeholder="" [formControlName]="'salarioBasico'"
                                    (keyup)="formOferta.controls['salarioBasico'].setValue(utility.formatearNumero(formOferta.value.salarioBasico)); ">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                            <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                <mat-label>Otros ingresos</mat-label>
                                <input matInput type="text" placeholder="" [formControlName]="'otrosIngresos'"
                                    (keyup)="formOferta.controls['otrosIngresos'].setValue(utility.formatearNumero(formOferta.value.otrosIngresos)); ">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                            <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                <mat-label>Comisiones por horas extras</mat-label>
                                <input matInput type="text" placeholder="" [formControlName]="'comisionesHorasExtras'"
                                    (keyup)="formOferta.controls['comisionesHorasExtras'].setValue(utility.formatearNumero(formOferta.value.comisionesHorasExtras)); ">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                            <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                <mat-label>Descuento de nomina</mat-label>
                                <input matInput type="text" placeholder="" [formControlName]="'descuentoNomina'"
                                    (keyup)="formOferta.controls['descuentoNomina'].setValue(utility.formatearNumero(formOferta.value.descuentoNomina)); ">
                                <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                </mat-icon>
                            </mat-form-field>
                        </div>

                        <div class="flex justify-content-around">
                            <div class="flex items-center justify-items-center">
                                <button mat-fab class=" bg-green-500" (click)="recalcularOferta()"
                                    matTooltip="Recalcular oferta">
                                    <mat-icon svgIcon="heroicons_outline:refresh"></mat-icon>
                                </button>
                            </div>
                        </div>

                        <div class="grid grid-cols-2">
                            <!-- <div class="flex gap-3">
                                <div class="bg-accent-100 flex flex-col w-9/12">
                                    <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                        <mat-label>Monto solicitido</mat-label>
                                        <input matInput type="text" placeholder="" [formControlName]="'valorSolicitado'"
                                            (keyup)="formOferta.controls['valorSolicitado'].setValue(utility.formatearNumero(formOferta.value.valorSolicitado)); ">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                    <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                        <mat-label>Plazo</mat-label>
                                        <input matInput type="text" placeholder="" [formControlName]="'plazo'"
                                            (keyup)="formOferta.controls['plazo'].setValue(utility.formatearNumero(formOferta.value.plazo)); ">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                    <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                        <mat-label>Salario básico</mat-label>
                                        <input matInput type="text" placeholder="" [formControlName]="'salarioBasico'"
                                            (keyup)="formOferta.controls['salarioBasico'].setValue(utility.formatearNumero(formOferta.value.salarioBasico)); ">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                    <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                        <mat-label>Otros ingresos</mat-label>
                                        <input matInput type="text" placeholder="" [formControlName]="'otrosIngresos'"
                                            (keyup)="formOferta.controls['otrosIngresos'].setValue(utility.formatearNumero(formOferta.value.otrosIngresos)); ">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                    <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                        <mat-label>Comisiones por horas extras</mat-label>
                                        <input matInput type="text" placeholder=""
                                            [formControlName]="'comisionesHorasExtras'"
                                            (keyup)="formOferta.controls['comisionesHorasExtras'].setValue(utility.formatearNumero(formOferta.value.comisionesHorasExtras)); ">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                    <mat-form-field class="w-100 px-3 fuse-mat-dense">
                                        <mat-label>Descuento de nomina</mat-label>
                                        <input matInput type="text" placeholder="" [formControlName]="'descuentoNomina'"
                                            (keyup)="formOferta.controls['descuentoNomina'].setValue(utility.formatearNumero(formOferta.value.descuentoNomina)); ">
                                        <mat-icon class="icon-size-5" matSuffix [svgIcon]="'mat_outline:edit'">
                                        </mat-icon>
                                    </mat-form-field>
                                </div>
                                <div class="flex items-center justify-items-center">
                                    <button mat-fab class=" bg-green-500" (click)="recalcularOferta()"
                                        matTooltip="Recalcular oferta">
                                        <mat-icon svgIcon="heroicons_outline:refresh"></mat-icon>
                                    </button>
                                </div>

                            </div> -->


                            <div *ngIf="capacidadPago$ | async as capacidadPago" class="cardBorder relative rounded-xl m-7">
                                <div class="flex flex-col items-center mt-1 w-full spanFlotante">
                                    <div class="bg-blue-700 text-xl font-medium px-3 rounded-2xl text-white">
                                        Capacidad de pago</div>
                                </div>
                                <ng-container *ngFor="let item of capacidadPago.data; let i = index">
                                    <div class="flex flex-col divide-y font-medium m-3">
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">
                                                <mat-icon class="icon-size-5 text-green-600"
                                                    [svgIcon]="'heroicons_solid:check'"></mat-icon>
                                                Disponible cuota
                                            </div>
                                            <div>
                                                <ng-container *ngIf="item.disponibleCuota">
                                                    $
                                                    {{
                                                    item.disponibleCuota | number
                                                    }}
                                                </ng-container>
                                            </div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">
                                                <mat-icon class="icon-size-5 text-green-600"
                                                    [svgIcon]="'heroicons_solid:check'"></mat-icon>
                                                Monto solicitado
                                            </div>
                                            <div>${{ item.monto | number }}</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Plazo</div>
                                            <div>{{ item.plazo }} meses</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Tasa</div>
                                            <div> {{ item.tasa | number:'1.2-2' }} %</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Salario básico</div>
                                            <div> ${{ item.salarioBasico | number }}</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Comisiones extras</div>
                                            <div> ${{ item.comisionesHorasExtras | number}} </div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Descuentos de ley</div>
                                            <div>$ {{ item.descuentosLey |number}}</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Ingresos brutos</div>
                                            <div> ${{ item.ingresosBrutos|number }}</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">50% ingresos brutos</div>
                                            <div> ${{ item.mitadIngresosBrutos }}</div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <div class="text-secondary">Factor embargo</div>
                                            <div> ${{ item.factorEmbargo }}</div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                            <div *ngIf="listadoOferta$ | async as listadoOferta">
                                <div class="flex gap-3 pt-4 ">
                                    <ng-container *ngFor="let item of listadoOferta.data; let i = index ">
                                        <div class="cardBorder relative rounded-xl">
                                            <div class="flex flex-col items-center mt-1 w-full spanFlotante">
                                                <div
                                                    class="bg-blue-700 text-xl font-medium px-3 rounded-2xl text-white">
                                                    Oferta</div>
                                            </div>

                                            <div class="p-3 flex flex-col mt-2 divide-y font-medium">
                                                <div class="flex flex-col items-center justify-center">
                                                    <button [disabled]="item.seleccionada == 'S'"
                                                        class="fuse-mat-button" mat-flat-button [color]="'primary'"
                                                        (click)="SelectOferta(item)">
                                                        Seleccionar
                                                    </button>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary">Valor estimado a desembolsar:</div>
                                                    <div>
                                                        <ng-container *ngIf="item.valorDesembolsar">
                                                            <b>${{item.valorDesembolsar | number}}
                                                            </b>
                                                        </ng-container>
                                                    </div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary"> Cuotas</div>
                                                    <div>${{ item.cuotas | number }}</div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary">Plazo</div>
                                                    <div>{{ item.plazo }} meses </div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary">Tasa</div>
                                                    <div> {{ item.tasa | number:'1.2-2' }} %</div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary">Garantía:</div>
                                                    <div>${{ item.garantia | number }}</div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary"> Cartera mora:</div>
                                                    <div>${{ item.carteraMora | number }}</div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary">Cartera a pagar</div>
                                                    <div>$ {{ item.carteraPagar }}</div>
                                                </div>
                                                <div class="flex  items-center justify-between">
                                                    <div class="text-secondary">Saldo a recoger</div>
                                                    <div>${{ item.garantia | number }}</div>
                                                </div>
                                            </div>

                                        </div>
                                    </ng-container>
                                </div>
                            </div>


                        </div>

                    </div>

                </mat-tab>
            </form>

        </ng-container>


    </mat-tab-group>
</ng-container>